# Javascript的Event Loop

js是单线程语言，意味着同一事件只能执行一个人任务，结束了才能去执行下一个。
如果前面的任务没有执行完，后面的任务就会一直等待。

任务队列分为同步任务和异步任务：
1. 同步任务，指的是在主线程上排队执行的任务，只有前一个任务执行完毕，才能执行后一个任务
2. 异步任务，指的是不进入主线程，而进入任务队列的任务，只有任务队列通知主线程，某个异步任务可以执行了，该任务才会进入主线程执行。

异步执行的运行机制：
1. 所有同步任务都在主线程上执行，形成一个执行栈
2. 主线程之外，还存在一个任务队列（task queue）。只要异步任务有了运行结果，就在任务队列之中放置一个事件
3. 一旦执行栈中的所有同步任务执行完毕，系统就会读取任务队列，看看里面有哪些事件。那些对应的异步任务，于是结束等待状态，进入执行栈，开始执行。
4. 主线程不断重复上面的第三步。

只要主线程空了，就会去读取“任务队列”。这就是js的运行机制，这个过程会不断重复。

主线程从“任务队列”中读取事件，这个过程是循环不断的，所以整个的这种运行机制又称为event loop（事件循环）。


任务队列总结：
1. 宏任务按顺序执行，且浏览器在每个宏任务之间渲染页面
2. 所有微任务也按顺序执行，且在以下场景会立即执行所有微任务
    每个回调之后且js执行栈中为空(只要执行栈为空，不管后面是否还有其他执行栈)
    每个宏任务结束后

微任务包含：promise和mutate
宏任务包含：setTimeout和click